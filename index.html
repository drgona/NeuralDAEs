<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Learning Neural Differential Algebraic Equations via Operator Splitting.">
  <meta name="keywords" content="NeuralDAEs, Operator Splitting, Neuromancer library">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Learning Neural Differential Algebraic Equations via Operator Splitting</title>


  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

<!--  to support latex -->
  <script type="text/javascript"
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Learning Neural Differential Algebraic Equations via Operator Splitting</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=wy4RgAEAAAAJ&hl=en">James Koch</a><sup>1</sup>,</span>
            <span class="author-block">
              Madelyn Shapiro <sup>1</sup>,</span>
            <span class="author-block">
             Himanshu Sharma <sup>1</sup>,
            </span>
            <span class="author-block">
               Draguna Vrabie <sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://drgona.github.io/">Jan Drgona</a><sup>1,2</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Pacific Northwest National Laboratory,</span>
            <span class="author-block"><sup>2</sup>Johns Hopkins University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2403.12938"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2403.12938"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/pnnl/NeuralDAEs"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-desktop">

    <div class="has-text-centered">
    <img src="./static/images/intro.png" alt="Neural DAE architecture" style="max-width: 80%; height: auto;" />
    <p><em>Figure: Schematic of the proposed operator splitting-based Neural Differential Algebraic Equation (DAE) Timestepper.</em></p>
  </div>
    <br>
    <br>

    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
Differential algebraic equations (DAEs) describe the temporal evolution of systems that obey both differential and algebraic constraints. Of particular interest are systems that contain implicit relationships between their components, such as conservation laws. Here, we present an Operator Splitting (OS) numerical integration scheme for learning unknown components of DAEs from time-series data. In this work, we show that the proposed OS-based time-stepping scheme is suitable for relevant system-theoretic data-driven modeling tasks. Presented examples include (i) the inverse problem of tank-manifold dynamics and (ii) discrepancy modeling of a network of pumps, tanks, and pipes. Our experiments demonstrate the proposed method's robustness to noise and extrapolation ability to
          (i) learn the behaviors of the system components and their interaction physics and (ii) disambiguate between data trends and mechanistic relationships contained in the system.
          </p>
        </div>
      </div>
    </div>
  </div>
    <!--/ Abstract. -->
</section>


<!-- paper summary -->
<section class="section">
  <div class="container is-max-desktop">


<!-- Problem Formulation -->
<div class="columns is-centered">
  <div class="column is-full-width">
    <h2 class="title is-3">Problem Formulation</h2>
    <div class="content has-text-justified">
      Differential-Algebraic Equations (DAEs) model dynamical systems governed by both differential dynamics and algebraic constraints—common in physical domains with conservation laws or implicit relationships.
      Traditional neural ODE models fail to capture these algebraic structures, motivating the need for neural architectures that can learn both explicit and implicit dynamics.
      The goal is to develop a data-driven framework for learning unknown or partially known DAE components from time-series data while maintaining consistency with the system’s inherent physical constraints.

     <br>
      We formulate the problem as learning two mappings \( f_\theta \) and \( g_\phi \) that represent the differential and algebraic components of the DAE system in the following parameter estimation problem:
     <br>
      <div style="text-align: center;">
        $$
        \begin{aligned}
        &\underset{\theta_f}{\text{minimize}} && \int_{t_0}^{t_N} \left( \|x(t) - \hat{x}(t)\|_2^2 + \|y(t) - \hat{y}(t)\|_2^2 \right) dt \\\\
        &\text{subject to} &&
        \dot{x}(t) = f(x(t), y(t), u(t); \theta_f), \\\\
        & && 0 = g(x(t), y(t), u(t)), \\\\
        & && x(t_0) = x_0, \quad y(t_0) = y_0,
        \end{aligned}
        $$
      </div>
      <br>
      where \( x(t) \in \mathbb{R}^{n_x} \) are the differential states, \( y(t) \in \mathbb{R}^{n_z} \) are algebraic states, \( u(t) \in \mathbb{R}^{n_u} \) are known inputs, and \( \theta_f \) are the learnable parameters.
    </div>
  </div>
</div>



<!-- Method -->
<div class="columns is-centered">
  <div class="column is-full-width">
    <h2 class="title is-3">Method</h2>
    <div class="content has-text-justified">
      We propose a modular neural DAE learning framework that decomposes the DAE system into two components:
      a neural surrogate for the algebraic solver, and a physics-constrained (gray-box) neural ordinary differential equation (ODE) model.
      The algebraic states are updated using a trainable neural network, while the differential states evolve via an ODE solver applied to a structured ODE.

      <br>
      The proposed operator splitting strategy is inspired by fractional-step numerical integration and is defined as:
      <br>
      <div style="text-align: center;">
        $$
        \begin{aligned}
            y^{(t+\Delta t)} & = h\left( x^{(t)}, y^{(t)}, u^{(t)}; \theta_h \right), \\\\
            x^{(t+\Delta t)} &= \text{ODESolve}\left(f, \{ x^{(t)}, y^{(t+\Delta t)}, u^{(t)} \}; \theta_f \right),
        \end{aligned}
        $$
      </div>
      <br>
      where \( h: \mathbb{R}^{n_x} \times \mathbb{R}^{n_y} \times \mathbb{R}^{n_u} \rightarrow \mathbb{R}^{n_y} \)
      is a neural surrogate for the algebraic update,
      \( f: \mathbb{R}^{n_x} \times \mathbb{R}^{n_y} \times \mathbb{R}^{n_u} \rightarrow \mathbb{R}^{n_x} \) is a neural ODE model,
      and \(\text{ODESolve}\) denotes a numerical ODE solver (e.g., explicit Runge-Kutta).


      <br>
      This architecture enables end-to-end training of neural DAEs with a constraint-aware loss function:
      <br>
      <div style="text-align: center;">
        $$
        \mathcal{L}(\Theta) = \lambda_1 \mathcal{L}_{\text{residual}}(X, \hat{X}; \Theta)
        + \lambda_2 \mathcal{L}_{\text{constraints}}(X, \hat{X}; \Theta),
        $$
      </div>
      <br>
      where \( \mathcal{L}_{\text{residual}} \) measures the error in predicted differential states,
      and \( \mathcal{L}_{\text{constraints}} \) penalizes violations of the algebraic constraints.
      Here, \( X \) are the model-predicted trajectories, and \( \hat{X} \) are the corresponding observations from the training dataset.
    </div>
  </div>
</div>
<!--/ Method -->



<!-- Examples -->
<div class="columns">
  <div class="column is-full-width">
    <h2 class="title is-3">Examples</h2>
    <div class="content has-text-justified">
      Our  Neural DAE framework and all our examples are implemented using the <a href="https://github.com/pnnl/neuromancer" target="_blank">Neuromancer library</a>.

     Let's consider tank-manifold-pump system governed by differential-algebraic equations.
      The goal is to learn the nonlinear area-height profile of a tank, and the implicit flow splitting rule at a manifold junction,
      only from observed time series of tank heights and input flow rates.

      <br><br>
      The full DAE system is given by:
      <div style="text-align: center;">
        $$
        \begin{aligned}
        \frac{dx_1}{dt} &= \frac{y_1}{3}, \\
        \frac{dx_2}{dt} &= \frac{y_2}{\sqrt{x_2} + 0.1}, \\
        0 &= u - y_1 - y_2, \\
        0 &= x_1 - x_2,
        \end{aligned}
        $$
      </div>
      <br>
      where \(x_1, x_2\) are the tank heights and \(y_1, y_2\) are the outlet flows.
      The model enforces mass conservation and equal pressure heads through algebraic constraints,
      while learning \(\phi_2(x_2) = \sqrt{x_2} + 0.1\) using a neural network.

      <div class="has-text-centered">
        <img src="./static/images/manifold.png" alt="Tank-manifold schematic" style="max-width: 80%; height: auto;"/>
        <p><em>Figure: Schematic of tank-manifold-pump system.</em></p>
      </div>
      <br>

      The learned model accurately reconstructs the tank heights and flow rates under both training and extrapolation conditions.

      <div class="has-text-centered">
        <img src="./static/images/tanks_flows_90.png" alt="Simulation results" style="max-width: 90%; height: auto;"/>
        <p><em>Figure: (a) Tank heights and (b) flow rates during training trajectory.</em></p>
      </div>

      <div class="has-text-centered">
        <img src="./static/images/extrap_HeightAreas_flows_90.png" alt="Extrapolation results" style="max-width: 90%; height: auto;"/>
        <p><em>Figure: Extrapolation of learned area-height relationship and resulting flow trajectories under unseen input.</em></p>
      </div>
   <br>

      The model demonstrates the ability to learn interpretable component dynamics while satisfying algebraic constraints and to generalize beyond the training regime.
    </div>
  </div>
</div>
<!--/ Examples -->



    </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{koch2025,
      title={Learning Neural Differential Algebraic Equations via Operator Splitting},
      author={James Koch and Madelyn Shapiro and Himanshu Sharma and Draguna Vrabie and Jan Drgona},
      year={2025},
      eprint={2403.12938},
      archivePrefix={arXiv},
      primaryClass={cs.LG},
      url={https://arxiv.org/abs/2403.12938},
      volume={},
      number={},
      booktitle={Conference on Decision and Control (CDC)},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://github.com/drgona/NeuralDAEs" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
           Website based on <a
              href="https://github.com/nerfies/nerfies.github.io">Nerfies template</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
